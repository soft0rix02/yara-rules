/*
  Yara created from diff results for ScareCrow samples. 
*/
rule ScareCrow_Malware
{
	meta: 
		date = "2023-10-03"
		yarahub_uuid = "40b7ba1b-fdef-4181-ad6f-7015f4467aaf"
		yarahub_license = "CC0 1.0"
        yarahub_rule_matching_tlp = "TLP:WHITE"
        yarahub_rule_sharing_tlp = "TLP:WHITE"
        yarahub_reference_md5 = "23ff15d2d88c243499b0e9d8d9f5445a"
		author = "schmidtsz"
		description = "Identify ScareCrow/GoShell samples"
	strings:
		$0 = {0A846E69BBC09E99F889BEEAD49C06C10D25CA43EA7006C0762C6E250A4448F128575E6A92060438CADB6457862ACD96F2ECF504370805C6BC123EED277580BC2E6833C6444A86F76B978DE87192A0EB1D21E0FB6AEEB37AA37E5831875B44936429D8BA05EA60594C9EAEFD687215B8BD338E298724B96FDF451A3D}
		$1 = "3333333333444444444455666677777888888888889999999999"
		$2 = {092B0C510B1D0E4E0D2810510F1D124E11291456131E164E15281857171D1A4E192B1C511B1D1E4E1D2820511F1D224E21292456231E264E25282857271D2A4E292B2C512B1D2E4E2D2830512F1D324E31293456331E364E35283857371D3A4E39BE053C573B203E553D1E404E3F284257411D444E432B4651451D484E47284A51491D4C4E4B294E564D1E504E4F285257511D544E532B5651551D584E57285A51591D5C4E5B295E565D1E604E5F286257611D644E632B6651651D684E67286A51691D6C4E6B296E566D1E704E6F287257711D744E73EB}
		$3 = {7379102C2CD8F4536FCE8ADF995AE969E84B8A9B1B07799405C1B62BA0D89184E2DE6C82E24897F94671A436C84EB6259B1608231B1BFDB7988D4D447AE2E3F7200EE5F5F030FE727F78B06A8C6D8E35A9515E332DBDBD4F9F965C85EF08B28213E63580782CAD2347BCB3662B8BDE31CCAF2150CB3B4C76AC55}
		$4 = {918EE7AACB34A5373E93B0ADA4B5BB273672A195FE818EC50DB81CD90DA3AAB1C3CE093B7E22F23611E6B1A7E8A50A4F3A21E6E48E5557C2CA8F9DD1624FCDE288A91F9EF22AED72BDB305863BA3801BEB93A745AF75A8CFACE0C333056630F172BC888B8D49C9016C8CB480867F7CAD8FEB6AEEF0}
		$5 = {6B300662C1D08F6C18779889A4488F9686BC87BAF1C4B387DE94FEABCD1A333CA8AB29292EB6E0140B1D7F8BC0F09F25490BBAD9DC718CD94DE45EAEF0EC076F1B8E2810548EAF50619DF6D92CE8C94AA2B13214E971DBD25C223A081C31BE6E05AF9FAC31278906F4AA480A63BD6DCA}
		$6 = {5C2042BD7F0E9581110584E5999C61B273A892AC1F52FAE15506E55EC0C3F99E9052B797A7E6785AEB479E76B0F45C639A93D2BE28908B18F3EC224AEE9833FC803887EE3274AEDE2FA8ABDC29BF3F3BA10629AA3F115AD63B92D653F4EE07C524A459CAC74AF865651B66B45895}
		$7 = {6B3CE8B9DCAD0DAFA234AD6D1DD778DD854B62E853D968ADE5408C6472866BAA336F3D71D487C2181F51AFFD0E68069500CB8C8DC9A9F2DE66251BBD120248BAC0FDEFF03BD4574B60F730B64B016D7498FE9576A5842D5E3835BDA39E4188913E}
		$8 = {20689FDB9873A6052AED82CAC268DB8C14A143893F0888433AD491BE792189B05989946B4F0A6AD44849362ED869AB1CB0AB7946E38C84099BDBC3394E44D6114E0B0C0C0ED8F2E540691AE4B0EA8595210E0F8F118E6F1F9103211D5D65A7}
		$9 = "ESTCSTCDTMSTMDT-02EDTASTADTPSTPDTNSTNDT+06+03+04+07IST+09+08IDT+12PKT+11KST+05JST+10-"
		$10 = "cgocallbackg1.fun"
		$11 = "CgoTraceback.fun"
		$12 = {50443BCF958890FEC0EF8FC6E7B9267764150A43BBAA343EF1F519DC303478CA5E4DE609B5EAE0C6967220133D41167DB6E05F4C62259978BC8FE8578CD15B1C}
		$13 = "f ) =  <==GOGC] =  pc=: p=cas1cas2cas3cas4cas5cas6 at \n\tm= sp= sp: lr: fp=) m=icmpigm"
  condition:
    all of them
}