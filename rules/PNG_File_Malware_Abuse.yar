rule PNG_File_Malware_Abuse {
    meta:
        description = "Detects malicious PNG files leveraging this technique"
        author = "d1v35h"
        date = "2025-01-02"
        yarahub_reference_md5 = "a9053a6606748a87a135b942eb47a8c0"
	yarahub_uuid = "f7e0a82d-3a34-4f47-bd19-20db5643ab16"
	yarahub_license	= "CC0 1.0"
	yarahub_rule_matching_tlp = "TLP:WHITE"
	yarahub_rule_sharing_tlp = "TLP:WHITE"
	malpedia_family	= "win.netsupportmanager_rat"
    strings:
        $png_header = { 69 70 63 6f 6e 66 69 67 20 2f 66 6c 75 73 68 64 6e 73 0d }  
        $powershell_indicator = "powershell.exe"
        $exe = "client32.exe"
    condition:
        $png_header at 0 and (1 of ($powershell_indicator, $exe))
}
